<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SOS Emergency Tool 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: 'Prompt', sans-serif;
            margin: 0; padding: 0;
            background: #f0f2f5; /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡πÜ ‡πÅ‡∏ö‡∏ö Facebook/WordPress */
            display: flex; justify-content: center;
        }
        .container {
            width: 100%; max-width: 500px;
            background: #ffffff;
            min-height: 100vh;
            padding: 25px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        header { text-align: center; margin-bottom: 25px; }
        h2 { color: #d32f2f; margin: 0; font-size: 26px; }
        
        /* Coordinate Card */
        .card {
            background: #fff;
            border-radius: 15px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            margin-bottom: 20px;
            text-align: center;
        }
        .status-dot {
            height: 10px; width: 10px; background-color: #bbb;
            border-radius: 50%; display: inline-block; margin-right: 5px;
        }
        .active-dot { background-color: #4caf50; box-shadow: 0 0 8px #4caf50; }

        .coord-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0; }
        .coord-item { background: #f8f9fa; padding: 10px; border-radius: 10px; }
        .label { font-size: 11px; color: #777; text-transform: uppercase; }
        .value { font-size: 16px; font-weight: bold; color: #333; display: block; }

        /* Buttons */
        .btn {
            width: 100%; padding: 16px; border: none; border-radius: 12px;
            font-family: 'Prompt'; font-size: 17px; font-weight: 600;
            cursor: pointer; transition: 0.2s; margin-bottom: 12px;
            display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .btn:active { transform: scale(0.97); opacity: 0.9; }
        
        .btn-gps { background: #1a73e8; color: white; }
        .btn-copy { background: #34a853; color: white; display: none; }
        .btn-camera { background: #8e44ad; color: white; }
        .btn-call { background: #d32f2f; color: white; font-size: 22px; margin-top: 20px; box-shadow: 0 4px 12px rgba(211,47,47,0.3); }

        /* Gallery */
        #photo-gallery {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 15px;
        }
        .photo-container {
            position: relative; width: 100%; padding-top: 100%;
        }
        .photo-container img {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; border-radius: 8px; border: 1px solid #ddd;
        }
        .save-badge {
            position: absolute; bottom: 5px; right: 5px;
            background: rgba(0,0,0,0.6); color: white; font-size: 9px;
            padding: 2px 5px; border-radius: 4px;
        }

        .address-info {
            background: #fff9c4; padding: 12px; border-radius: 8px;
            font-size: 14px; color: #555; text-align: left; margin-bottom: 15px;
            display: none; border-left: 4px solid #fbc02d;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h2>üÜò SOS ‡∏î‡πà‡∏ß‡∏ô</h2>
        <p style="font-size: 13px; color: #666;">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏à‡πâ‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô</p>
    </header>

    <div class="card">
        <div id="status-area">
            <span id="dot" class="status-dot"></span>
            <span id="status-text" style="font-size: 14px; color: #666;">‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏Å‡∏î‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á...</span>
        </div>

        <div class="coord-grid">
            <div class="coord-item">
                <span class="label">Lat</span>
                <span id="lat-val" class="value">-</span>
            </div>
            <div class="coord-item">
                <span class="label">Lon</span>
                <span id="lon-val" class="value">-</span>
            </div>
        </div>

        <div id="address-display" class="address-info"></div>

        <button class="btn btn-gps" onclick="getLocation()">
            üìç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
        </button>
        
        <button id="btn-copy-link" class="btn btn-copy" onclick="copyMapLink()">
            üîó ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà (‡∏™‡πà‡∏á‡∏ó‡∏≤‡∏á‡πÅ‡∏ä‡∏ó)
        </button>
    </div>

    <div class="card">
        <button class="btn btn-camera" onclick="document.getElementById('fileInput').click()">
            üì∏ ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ/‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏†‡∏≤‡∏û‡∏•‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
        </button>
        <input type="file" id="fileInput" accept="image/*" capture="camera" style="display: none" onchange="processImage(this)">
        
        <div id="photo-gallery"></div>
        <p id="helper-text" style="font-size: 12px; color: #999; margin-top: 10px;">‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ñ‡πà‡∏≤‡∏¢‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
    </div>

    <button class="btn btn-call" onclick="confirmCall()">
        üìû ‡πÇ‡∏ó‡∏£‡πÅ‡∏à‡πâ‡∏á 191
    </button>
</div>

<script>
    let mapLink = "";

    // 1. ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
    function getLocation() {
        const sText = document.getElementById('status-text');
        const dot = document.getElementById('dot');
        
        sText.textContent = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏û‡∏¥‡∏Å‡∏±‡∏î...";
        
        navigator.geolocation.getCurrentPosition((pos) => {
            const lat = pos.coords.latitude.toFixed(6);
            const lon = pos.coords.longitude.toFixed(6);
            
            document.getElementById('lat-val').textContent = lat;
            document.getElementById('lon-val').textContent = lon;
            
            dot.classList.add('active-dot');
            sText.textContent = "‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
            sText.style.color = "#2e7d32";

            mapLink = `https://www.google.com/maps?q=${lat},${lon}`;
            document.getElementById('btn-copy-link').style.display = "flex";

            // ‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏ö‡∏ö‡∏¢‡πà‡∏≠
            fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&accept-language=th`)
                .then(r => r.json()).then(data => {
                    const addr = document.getElementById('address-display');
                    addr.style.display = "block";
                    addr.textContent = "üìç " + (data.display_name.split(',')[0] || "‡∏û‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á");
                });

        }, (err) => {
            alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î GPS ‡πÅ‡∏•‡∏∞‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå");
            sText.textContent = "‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
        }, { enableHighAccuracy: true });
    }

    // 2. ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå
    function copyMapLink() {
        navigator.clipboard.writeText(mapLink).then(() => {
            const btn = document.getElementById('btn-copy-link');
            btn.innerHTML = "‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!";
            setTimeout(() => { btn.innerHTML = "üîó ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà (‡∏™‡πà‡∏á‡∏ó‡∏≤‡∏á‡πÅ‡∏ä‡∏ó)"; }, 2500);
        });
    }

    // 3. ‡∏£‡∏∞‡∏ö‡∏ö‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
    function processImage(input) {
        if (input.files && input.files[0]) {
            const file = input.files[0];
            const reader = new FileReader();

            reader.onload = function(e) {
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏†‡∏≤‡∏û Preview
                const gallery = document.getElementById('photo-gallery');
                const container = document.createElement('div');
                container.className = 'photo-container';
                container.innerHTML = `
                    <img src="${e.target.result}">
                    <span class="save-badge">Saved</span>
                `;
                gallery.prepend(container);

                // ‡∏™‡∏±‡πà‡∏á‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏•‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (Auto-Save)
                const saveLink = document.createElement('a');
                saveLink.href = e.target.result;
                saveLink.download = `SOS_IMG_${Date.now()}.jpg`;
                document.body.appendChild(saveLink);
                saveLink.click();
                document.body.removeChild(saveLink);
            };
            reader.readAsDataURL(file);
        }
    }

    // 4. ‡πÇ‡∏ó‡∏£‡∏≠‡∏≠‡∏Å
    function confirmCall() {
        if(confirm("‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏ó‡∏£‡∏´‡∏≤ 191 ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) {
            window.location.href = "tel:191";
        }
    }
</script>

</body>
</html>
